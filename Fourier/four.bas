20 CLS:  Locate 1,2 : Print "TOURIER ANALYSE"
22  Locate 3,2 : Print "1.EXAMPLE "
24  Locate 4,2 : Print "2 EXAMPLE "
26  Locate 5,2 : Print "3.EXAMPLE "
28  Locate 7,2 : PRINT "INPUT 1/2/3"
29  Locate 9,2 : PRINT "END"

30 INPUT N

31 IF N<1 OR N>3 THEN Stop

If N=1 Then 100 : If N=2 Then 200 : If N=3 Then 300 

Rem 32 GOTO 100*N

45 CLS

46 PRINT "

47 PRINT 

48 PRINT 

49 Print " NP>2*NH+1 "

50 INPUT "NUMBER OF HARMONICS - ",NH

60 INPUT "NUMBER OF POINTS - ",NP

70 DIM F(NP+1) : DIM S(NP+1) : DIM C(NP+1)

75 IF NP < 2*NH+1 THEN GOTO 50

80 RETURN

100 REM 1

110 GOSUB 45

115 LET F(1)=1 : LET DY=2/NP

120 FOR I=2 TO NP

125 LET F(I)=F(M)+DY : NEXT I

130 LET F(1)=0 : LET F(NP+1)=F(1)

140 GOTO 500

200 REM 2

205 GOSUB 45

210 ReDim F(NP+1)

215 LET F(1)=0 : LET DY=2/NP

220 FOR I=2 TO NP/2

225 LET F(I)=F(M)+DY : NEXT I

230 LET F(NP/2+1)=0.5

235 FOR I=NP/2+2 TO NP+1

240 LET F(IJ)=0 : Next I

250 GoTo 500

300 REM 3

305 GOSUB 45

310 LET F(1)=0 : LET F(N/2+1)=0

315 LET F(NP+1H)

320 For I=2 TO NP/2

325 LET F(I)=0.75 : Next I

330 FOR I=NP/2+2 TO NP

335 LET F(l)--0.75 : NEXT1

340 GO TO 500

500 REM FOURIER -ANALYSE

502 CIS

505 PRINT LOCATE 1,2;*N"; LOCATE 1,10;"COS"; LOCATE 1,20;"SIN"

510 LET Z-2/NP: LET P-0

520 LET CI-COS (Z*PI): LET SI- SIN (Z*PI)

530 LET C-1: LET S-0; LET P-0

540 LET U1-0: LET U2-0

550 LET N-NP

560 LET U0-F(N)+2*C*U 1-U2

570 LETU2-U1: LET U1-U0: LET N-N-1

580 IF N-1 THEN GO TO 600

590 GO TO 560

600 LET A-Z*(F(1)+C*U1-U2)

610 LET B-Z*S*U1

615 LET EPS-1E-6

620 IF ABS (A)<EPS THEN LET A-0

630 IF ABS |B)<EPS THEN LET B-0

632 LET J-10000

634 LET A-INT (/A)/! LET C(P+1)-A
636 LET B-INT (ÃÂ)/>. LET S(P+1)-B
638 IF P-0 THEN LET A-A/2
640 PRINT LOCATE P+3,2;P; Locate P+3,10A
Locate P+3,20;B

650 IF P-NH THEN GO TO 900

660 LET Q-Cl *C-S1 *S

670 LETS-CrS+SrC

680 LET C-Q: LET P-P+1: GO TO 540

900 GOSUB 1990

999 IF INKEYS-" THEN GO TO 999

1000 REM SPECTR.UNE
1010 CLS

1012 PRINT Locate 1,2;*FOURIER KOEFF."

1015 PRINT LOCATE 3,2;'SINUS';LOCATE 3,16;"COSINUS'

1020 PLOT 10,30: DRAW 100,0

1040 PLOT 130,30: DRAW 100,0

1060 FOR 1-0 TO NH

1070 PLOT 10*1+10,30: DRAW 0,100*ABS S|l+1)

1080 NEXT I

1090 FOR 1-0 TO NH

1100 PLOT 10*1+130,30:DRAW 0,100*ABS C(l+1)
1110 NEXT I
1115 GOSUB 1900

1120 IF INKEYS THEN GO TO 1120
1200 REM
1210 CIS

1220 PLOT 20,95: DRAW 180,0

1230 LET C(1)-qi)/2

1240 FOR P-1 TO NH

1250 IF S(P)-0 THEN GOTO 1310

1260 FOR 1-0 TO 360 STEP 5

1270 LET Y-S(P)*SIN (|P-1)*2*P11/360): LET Y-Y*70+95

1280 LET X- INT (1/2+20)

1290 PLOT X,Y

1300 NEXT I

1310 IF C(P)-0 THEN GO TO 1390

1320 FOR 1-0 TO 360 STEP 5

1330 LET Y-qP)*COS |(P-1)*2'PI '1/360): LET Y-Y*70+95

1340 LET X- INT (1/2+20)

1350 PLOT X,Y

1360 NEXT I

1390 NEXT P

1392 GOSUB 1990

1395 IF INKEYS-" THEN GO TO 1395

1400 REM SUMM

1410 CLS

1415 Locate 1,2 : Print "SUMM"

1420 PLOT 20,95 : Draw 180, 0

1430 FOR 1-0 TO 360 STEP 5

1440 LET Y-0

1450 FOR P-1 TO NH

1460 LET Vy-{P-1)*2*PI 4/360

1470 LET Y*Y+S(P)*SIN W+C(P)* COS W

1480 NEXT P

1490 LET Y-INT (Y=70+95) : LET X- INT (1/2+20)

1500 PLOT X,Y

1510 NEXT I

1520 LET X-180/NP

1530 LET Y-F(11*70+95

1535 LET XP-20

1540 PLOT XP,Y

1550 FOR 1-2 TO NP+1

1560 LET Y1 -Y: LET XI -XP

1570 LET XP-F(l)*70+95

1575 LET XP- INT (X'(l-l)+20.5)

1580 DRAW XP-X1,Y-Y1

1590 NEXT I

1600 GOSUB 1990

1610 IF INKEYS-" THEN GO TO 1610

1620 GO TO 20

1990 LOCATE 20,2 : PRINT "CONTINUE" : RETURN

1999 STOP

2000 FOR i = 1 TO NP+1

2010 PRINT F(i)

2020 NEXT i
